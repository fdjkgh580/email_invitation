<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title></title>
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="../src/jquery.vmodel.js"></script>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
    <p>
        可以發現我們這次在 vmodel() 的第一個參數，使用了『--』當作前綴字元，這是為了讓你搜尋程式碼時，打上如『--user』你就可以很快的找到定義 vmodel() 的位置。但記得喔，我們透過 $.vmodel.get() 外部呼叫模組時，務必省略掉 『--』。
    </p>
    <p>
        這個範例中，每個模組只負責自己的事情。--user 只做表單的事情，例如取得文字、送出文字、綁定按鈕。但是送出後要如何顯示，那就不屬於 --user 該做的；而是 --message 。
    </p>
    <p>
        這樣一來，我們各自維護不同模組時，腦袋也會也很清晰。例如表單需要擴增姓名填寫，那我們只需要找到 --user 的地方改程式碼就可以，不用怕被 --message 相關的程式碼干擾。概念，就跟物件導向設計一樣。
    </p>
    <h1>--user</h1>
    <pre>
//使用者操作模組
$(".user").vmodel("--user", true, function (){
    var vs = this;

    //綁定自動觸發
    this.autoload = ['sned'];
    
    //事件綁定
    this.sned = function (){

        // 這會對 .user 底下的 .send 做綁定 click 事件
        vs.root.on("click", ".send", function (){

            // 透過自己的 function 取得使用者說的話
            var text = vs.say();

            // 傳給外部 message 模組，顯示使用者說的話
            $.vmodel.get("message").show(text);
            
            //這只是避免 form 送出
            return false; 
        });
    }

    // 取得使用者說的話，並稍作過濾
    this.say = function(){
        var val = vs.root.find(".say").val();
        return $.trim(val);
    }
});
        </pre>
        <h1>--message</h1>
        <pre>
// 訊息模組，我們可以使用 false 避免觸發 autoload 
$(".message").vmodel("--message", false, function (){
    var vs = this;

    // 雖然我們不會用到自動觸發，保持空陣列，或刪掉這行
    this.autoload = [];

    // 輸出文字
    this.show = function (val){
        
        // 先讓整個區塊顯示
        vs.root.removeAttr("hidden");
        
        // 再設定文字
        vs.root.find(".something").text(val);
    }
});

        </pre>
        <h1>HTML</h1>
        <pre>
&lt;form class="user"&gt;
    &lt;input type="text" class="say" placeholder="打一些你想說的話"&gt;
    &lt;button class="send"&gt;送出&lt;/button&gt;
&lt;/form&gt;

&lt;div class="message" hidden&gt;
    &lt;span&gt;你說了：&lt;/span&gt;
    &lt;span class="something"&gt;&lt;/span&gt;
&lt;/div&gt;
        </pre>

    <hr>
    <h1>示範</h1>
    <script>
    $(function (){

        //使用者操作模組
        $(".user").vmodel("--user", true, function (){
            var vs = this;

            //綁定自動觸發
            this.autoload = ['sned'];
            
            //事件綁定
            this.sned = function (){

                // 這會對 .user 底下的 .send 做綁定 click 事件
                vs.root.on("click", ".send", function (){

                    // 透過自己的 function 取得使用者說的話
                    var text = vs.say();

                    // 傳給外部 message 模組，顯示使用者說的話
                    $.vmodel.get("message").show(text);
                    
                    //這只是避免 form 送出
                    return false; 
                });
            }

            // 取得使用者說的話，並稍作過濾
            this.say = function(){
                var val = vs.root.find(".say").val();
                return $.trim(val);
            }
        });
        
        // 訊息模組，我們可以使用 false 避免觸發 autoload 
        $(".message").vmodel("--message", false, function (){
            var vs = this;

            // 雖然我們不會用到自動觸發，保持空陣列，或刪掉這行
            this.autoload = [];

            // 輸出文字
            this.show = function (val){
                
                // 先讓整個區塊顯示
                vs.root.removeAttr("hidden");
                
                // 再設定文字
                vs.root.find(".something").text(val);
            }
        });

    })
    </script>

    <form class="user">
        <input type="text" class="say" placeholder="打一些你想說的話">
        <button class="send">送出</button>
    </form>

    <div class="message" hidden>
        <span>你說了：</span>
        <span class="something"></span>
    </div>

</div>

</body>
</html>